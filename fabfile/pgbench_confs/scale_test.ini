[DEFAULT]
postgres_citus_versions: [('11.5', 'release-9.1'), ('11.5', 'release-9.0')]
shard_counts_replication_factors: [(32, 1)]
postgresql_conf: [
                 "max_wal_size = '5GB'",
                 "checkpoint_timeout = '1h'",
                 "max_connections = 1000",
                 "max_prepared_transactions = 1000",
                 "shared_buffers = '256MB'",
                 "citus.multi_shard_commit_protocol = '2pc'"
                 ]
use_enterprise: on

[create_type]
sql_command: CREATE TYPE complex AS (r double precision, i double precision);

[distribute_type]
sql_command: SELECT run_command_on_workers('CREATE TYPE complex AS (r double precision, i double precision)');

[create_table]
sql_command: CREATE TABLE test_table (key int, occurred_at timestamp DEFAULT now(), value_1 jsonb, value_2 text[], value_3 int4range, value_4 complex NOT NULL);
distribute_table_command: SELECT create_distributed_table('test_table', 'key');

[create_indexes_key]
sql_command: CREATE INDEX i1 ON test_table(key);

[create_indexes_value_1]
sql_command: CREATE INDEX i2 ON test_table USING HASH(value_1); CREATE INDEX i3 ON test_table USING GIN(value_1);

[create_indexes_value_2]
sql_command: CREATE INDEX i4 ON test_table(value_2); CREATE INDEX i5 ON test_table USING GIN(value_2);

[create_indexes_value_3]
sql_command: CREATE INDEX i6 ON test_table USING GIST(value_3);

[single_insert]
pgbench_command: pgbench -c128 -j16 -T 300 -P 10 -n -r -f fabfile/pgbench_scripts/insert_complex.sql

[muti_row_insert]
pgbench_command: pgbench -c32 -j16 -T 300 -P 10 -n -r -f fabfile/pgbench_scripts/scale_multi_row_insert.sql

[router_select]
pgbench_command: pgbench -c128 -j16 -T 300 -P 10 -n -r -f fabfile/pgbench_scripts/router_select.sql

[realtime_select]
pgbench_command: pgbench -c4 -j4 -T 300 -P 10 -n -r -f fabfile/pgbench_scripts/realtime_select.sql

[insert_select_pushdown]
sql_command: CREATE TABLE test_table_target (key int, occurred_at timestamp DEFAULT now(), value_1 jsonb, value_2 text[], value_3 int4range, value_4 complex NOT NULL);
distribute_table_command: SELECT create_distributed_table('test_table_target', 'key');
pgbench_command: pgbench -c4 -j4 -T 300 -P 10 -n -r -f fabfile/pgbench_scripts/insert_select_pushdown.sql

[insert_select_coordinator]
pgbench_command: pgbench -c16 -j8 -T 300 -P 10 -n -r -f fabfile/pgbench_scripts/insert_select_coordinator.sql

[copy]
sql_command: COPY (SELECT * FROM test_table LIMIT 100) TO '${HOME}/scale_test_data.csv';
pgbench_command: pgbench -c8 -j8 -T 300 -P 10 -n -r -f fabfile/pgbench_scripts/scale_copy.sql

[copy_and_multi_row]
pgbench_command: pgbench -c16 -j8 -T 300 -P 10 -n -r -f fabfile/pgbench_scripts/scale_copy.sql@1 -f fabfile/pgbench_scripts/scale_multi_row_insert.sql@25

[mix_them_all]
pgbench_command: pgbench -c8 -j4 -T 300 -P 10 -n -r \
    -f fabfile/pgbench_scripts/insert_complex.sql@5 \
    -f fabfile/pgbench_scripts/scale_multi_row_insert.sql@5 \
    -f fabfile/pgbench_scripts/router_select.sql@5 \
    -f fabfile/pgbench_scripts/realtime_select.sql@1 \
    -f fabfile/pgbench_scripts/insert_select_pushdown.sql@1 \
    -f fabfile/pgbench_scripts/insert_select_coordinator.sql@1 \
    -f fabfile/pgbench_scripts/scale_copy.sql@1
